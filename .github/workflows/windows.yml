name: windows
on:
  # push:
  #  branches: ["main"]
  workflow_dispatch:

jobs:
  build:
    runs-on: windows-11-arm
    defaults:
      run:
        shell: bash
    steps:
      - run: |
          pipx install conan
          conan profile detect
      # - run: |
      #     p=sdl/2.32.2
      #     conan install --requires $p -b $p -o "$p:sdl2main=True" -o "$p:shared=True" \
      #       -c "$p:tools.cmake.cmaketoolchain:extra_variables={'SDL_LIBC': 'ON'}"
      - run: |
          cciForkRepo='cci-fork'
          branchName='patch-1'
  
          git clone "https://github.com/kambala-decapitator/conan-center-index.git" "$cciForkRepo" \
            --branch "$branchName" \
            --no-checkout \
            --depth 1 \
            --no-tags \
            --single-branch \
            --sparse
          cd "$cciForkRepo"
          git sparse-checkout set \
            recipes/opusfile \
  
          git checkout
          conan create "recipes/opusfile/all" \
            --version=0.12 \
            --build=missing \
            --test-folder= \
            -o 'opusfile/*:http=False'

      # - uses: actions/checkout@v4

      # - name: Upload artifact
      #   uses: actions/upload-artifact@v4
      #   with:
      #     name: ffmpeg-build-dir
      #     compression-level: 0
      #     path: |
      #       ${{ env.CONAN_HOME }}/p/b/ffmp*/b/build-release
